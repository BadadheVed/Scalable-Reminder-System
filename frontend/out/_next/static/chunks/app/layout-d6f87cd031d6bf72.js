(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{3271:function(e,t,r){Promise.resolve().then(r.t.bind(r,8877,23)),Promise.resolve().then(r.bind(r,3256)),Promise.resolve().then(r.bind(r,220)),Promise.resolve().then(r.bind(r,6762)),Promise.resolve().then(r.t.bind(r,3247,23))},1045:function(e,t,r){"use strict";r.d(t,{b:function(){return a}});var s=r(4829);let o="http://localhost:8000",a=s.Z.create({baseURL:o,withCredentials:!0,headers:{"Content-Type":"application/json"}});console.log("Backend URL:",o)},3256:function(e,t,r){"use strict";r.r(t),r.d(t,{Toaster:function(){return c}});var s=r(7437),o=r(2265),a=["light","dark"],l=o.createContext(void 0),n={setTheme:e=>{},themes:[]},u=()=>{var e;return null!=(e=o.useContext(l))?e:n};o.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:s,enableColorScheme:l,defaultTheme:n,value:u,attrs:i,nonce:c})=>{let d="system"===n,f="class"===r?`var d=document.documentElement,c=d.classList;c.remove(${i.map(e=>`'${e}'`).join(",")});`:`var d=document.documentElement,n='${r}',s='setAttribute';`,h=l?(a.includes(n)?n:null)?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${n}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",m=(e,t=!1,s=!0)=>{let o=u?u[e]:e,n=t?e+"|| ''":`'${o}'`,i="";return l&&s&&!t&&a.includes(e)&&(i+=`d.style.colorScheme = '${e}';`),"class"===r?t||o?i+=`c.add(${n})`:i+="null":o&&(i+=`d[s](n,${n})`),i},g=e?`!function(){${f}${m(e)}}()`:s?`!function(){try{${f}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${d})){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){${m("dark")}}else{${m("light")}}}else if(e){${u?`var x=${JSON.stringify(u)};`:""}${m(u?"x[e]":"e",!0)}}${d?"":"else{"+m(n,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${t}');if(e){${u?`var x=${JSON.stringify(u)};`:""}${m(u?"x[e]":"e",!0)}}else{${m(n,!1,!1)};}${h}}catch(t){}}();`;return o.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:g}})});var i=r(1424);let c=e=>{let{...t}=e,{theme:r="system"}=u();return(0,s.jsx)(i.x7,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})}},220:function(e,t,r){"use strict";r.r(t),r.d(t,{AuthProvider:function(){return c},useAuth:function(){return i}});var s=r(7437),o=r(2265),a=r(4033),l=r(1045),n=r(1424);let u=(0,o.createContext)(null),i=()=>{let e=(0,o.useContext)(u);if(!e)throw Error("useAuth must be used within AuthProvider");return e},c=e=>{let{children:t}=e,[r,i]=(0,o.useState)(null),[c,d]=(0,o.useState)(!0),[f,h]=(0,o.useState)(null),[m,g]=(0,o.useState)(null),v=(0,a.useRouter)();(0,o.useEffect)(()=>{p()},[]),(0,o.useEffect)(()=>{r&&r.email!==m&&null!==m&&(console.log("Email changed detected, refetching user data"),p())},[null==r?void 0:r.email,m]);let p=async()=>{try{d(!0),h(null),console.log("Fetching user data from /auth/me");let e=await l.b.get("/auth/me");if(e.data.success&&e.data.user){let t=e.data.user;i(t),g(t.email),console.log("User data fetched successfully:",t)}else i(null),g(null),h(e.data.message||"Failed to fetch user"),console.log("No user data received or unsuccessful response")}catch(s){var e,t,r;i(null),g(null),(null===(e=s.response)||void 0===e?void 0:e.status)!==401&&h((null===(r=s.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Authentication check failed"),console.error("Auth check error:",s)}finally{d(!1)}},y=async()=>{await p()},b=async(e,t)=>{try{d(!0);let r=await l.b.post("/auth/login",{email:e,password:t});if(r.data.success)await p(),n.Am.success("Login successful!"),v.push("/dashboard");else throw Error(r.data.message||"Login failed")}catch(t){var r,s;let e=(null===(s=t.response)||void 0===s?void 0:null===(r=s.data)||void 0===r?void 0:r.message)||"Login failed. Please try again.";throw n.Am.error(e),t}finally{d(!1)}},$=async(e,t,r)=>{try{d(!0);let s=await l.b.post("/auth/signup",{email:t,password:r,name:e});if(s.data.success)n.Am.success("Account created successfully! Please sign in."),v.push("/login");else throw Error(s.data.message||"Signup failed")}catch(t){var s,o;let e=(null===(o=t.response)||void 0===o?void 0:null===(s=o.data)||void 0===s?void 0:s.message)||"Account creation failed. Please try again.";throw n.Am.error(e),t}finally{d(!1)}},w=async()=>{try{await l.b.post("/auth/logout"),n.Am.success("Logged out successfully!")}catch(e){console.error("Logout error:",e),n.Am.error("Logout failed on server, but you have been logged out locally.")}finally{i(null),g(null),h(null),v.push("/login")}};return(0,s.jsx)(u.Provider,{value:{user:r,loading:c,error:f,login:b,signup:$,logout:w,setUser:i,refetchUser:y,updateUser:e=>{if(r){let t={...r,...e};i(t),e.email&&e.email!==m&&(console.log("Email changed via updateUser, will trigger refetch"),g(e.email))}}},children:t})}},6762:function(e,t,r){"use strict";r.r(t),r.d(t,{UserProvider:function(){return n},useAuth:function(){return i},useUser:function(){return u}});var s=r(7437),o=r(2265),a=r(1045);let l=(0,o.createContext)(void 0),n=e=>{let{children:t}=e,[r,n]=(0,o.useState)(null),[u,i]=(0,o.useState)(!0),[c,d]=(0,o.useState)(null),f=async()=>{try{i(!0),d(null);let e=await a.b.get("/auth/me");e.data.success?n(e.data.user):(d(e.data.message||"Failed to fetch user"),n(null))}catch(s){var e,t,r;(null===(e=s.response)||void 0===e?void 0:e.status)===401?(n(null),d(null),console.log("User not authenticated (no token)")):(d((null===(r=s.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.message)||"Failed to fetch user"),n(null),console.error("Error fetching user:",s))}finally{i(!1)}};return(0,o.useEffect)(()=>{f()},[]),(0,s.jsx)(l.Provider,{value:{user:r,loading:u,error:c,fetchUser:f,logout:()=>{n(null),d(null)},updateUser:e=>{n(t=>t?{...t,...e}:null)}},children:t})},u=()=>{let e=(0,o.useContext)(l);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e},i=()=>{let{user:e,loading:t,error:r,fetchUser:s,logout:o,updateUser:a}=u();return{user:e,loading:t,error:r,isAuthenticated:!!e,isLoading:t,hasError:!!r,refetchUser:s,signOut:o,updateUserData:a}}},8877:function(){},3247:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}}},function(e){e.O(0,[385,971,864,744],function(){return e(e.s=3271)}),_N_E=e.O()}]);