(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5531:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var r=s(2265);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=(...e)=>e.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:i,iconNode:u,...c},d)=>(0,r.createElement)("svg",{ref:d,...n,width:t,height:t,stroke:e,strokeWidth:a?24*Number(s)/Number(t):s,className:l("lucide",o),...c},[...u.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),i=(e,t)=>{let s=(0,r.forwardRef)(({className:s,...n},i)=>(0,r.createElement)(o,{ref:i,iconNode:t,className:l(`lucide-${a(e)}`,s),...n}));return s.displayName=`${e}`,s}},3715:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});var r=s(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r.Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7283:function(e,t,s){Promise.resolve().then(s.bind(s,9112))},9112:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(7437),a=s(2265),l=s(4033),n=s(220),o=s(3715),i=s(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,i.Z)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);function c(){let{user:e,loading:t}=(0,n.useAuth)(),s=(0,l.useRouter)(),[i,c]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{t||(e?s.push("/dashboard"):s.push("/login"))},[e,t,s]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{c(!0)},5e3);return()=>clearTimeout(e)},[]),t)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:(0,r.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,r.jsx)(o.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-primary"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Loading..."}),(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:(0,r.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,r.jsx)("strong",{children:"Notice:"})," OnRender.com cold start may cause delays during initial loading. Please wait a moment while the server wakes up."]})}),i&&(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"Taking longer than expected?"}),(0,r.jsxs)("button",{onClick:()=>{s.push("/login")},className:"inline-flex items-center px-4 py-2 bg-primary text-primary-foreground hover:bg-primary/90 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",children:[(0,r.jsx)(u,{className:"h-4 w-4 mr-2"}),"Go to Login"]})]})]})}):null}},1045:function(e,t,s){"use strict";s.d(t,{b:function(){return l}});var r=s(4829);let a="http://localhost:8000",l=r.Z.create({baseURL:a,withCredentials:!0,headers:{"Content-Type":"application/json"}});console.log("Backend URL:",a)},220:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return c},useAuth:function(){return u}});var r=s(7437),a=s(2265),l=s(4033),n=s(1045),o=s(1424);let i=(0,a.createContext)(null),u=()=>{let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e},c=e=>{let{children:t}=e,[s,u]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[h,m]=(0,a.useState)(null),[f,g]=(0,a.useState)(null),p=(0,l.useRouter)();(0,a.useEffect)(()=>{v()},[]),(0,a.useEffect)(()=>{s&&s.email!==f&&null!==f&&(console.log("Email changed detected, refetching user data"),v())},[null==s?void 0:s.email,f]);let v=async()=>{try{d(!0),m(null),console.log("Fetching user data from /auth/me");let e=await n.b.get("/auth/me");if(e.data.success&&e.data.user){let t=e.data.user;u(t),g(t.email),console.log("User data fetched successfully:",t)}else u(null),g(null),m(e.data.message||"Failed to fetch user"),console.log("No user data received or unsuccessful response")}catch(r){var e,t,s;u(null),g(null),(null===(e=r.response)||void 0===e?void 0:e.status)!==401&&m((null===(s=r.response)||void 0===s?void 0:null===(t=s.data)||void 0===t?void 0:t.message)||"Authentication check failed"),console.error("Auth check error:",r)}finally{d(!1)}},y=async()=>{await v()},x=async(e,t)=>{try{d(!0);let s=await n.b.post("/auth/login",{email:e,password:t});if(s.data.success)await v(),o.Am.success("Login successful!"),p.push("/dashboard");else throw Error(s.data.message||"Login failed")}catch(t){var s,r;let e=(null===(r=t.response)||void 0===r?void 0:null===(s=r.data)||void 0===s?void 0:s.message)||"Login failed. Please try again.";throw o.Am.error(e),t}finally{d(!1)}},w=async(e,t,s)=>{try{d(!0);let r=await n.b.post("/auth/signup",{email:t,password:s,name:e});if(r.data.success)o.Am.success("Account created successfully! Please sign in."),p.push("/login");else throw Error(r.data.message||"Signup failed")}catch(t){var r,a;let e=(null===(a=t.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.message)||"Account creation failed. Please try again.";throw o.Am.error(e),t}finally{d(!1)}},b=async()=>{try{await n.b.post("/auth/logout"),o.Am.success("Logged out successfully!")}catch(e){console.error("Logout error:",e),o.Am.error("Logout failed on server, but you have been logged out locally.")}finally{u(null),g(null),m(null),p.push("/login")}};return(0,r.jsx)(i.Provider,{value:{user:s,loading:c,error:h,login:x,signup:w,logout:b,setUser:u,refetchUser:y,updateUser:e=>{if(s){let t={...s,...e};u(t),e.email&&e.email!==f&&(console.log("Email changed via updateUser, will trigger refetch"),g(e.email))}}},children:t})}}},function(e){e.O(0,[385,971,864,744],function(){return e(e.s=7283)}),_N_E=e.O()}]);